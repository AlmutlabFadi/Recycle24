{
  "meta": {
    "project": "Recycle24",
    "date": "2026-02-21",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "Recycle24 is an integrated recycling marketplace connecting traders, buyers and drivers with auction, market and transport workflows, backed by Next.js, PostgreSQL and Prisma. The platform enables listing, bidding, transport matching and wallet-backed transactions with enterprise security controls.",
  "core_goals": [
    "Provide a marketplace for recyclable goods with auctions and fixed-price listings.",
    "Enable transport matching between shippers and drivers via offers, acceptance and dispatch workflows.",
    "Support account management for traders, buyers, drivers and admins with secure authentication.",
    "Offer wallet functionality to settle transactions and withdrawals.",
    "Embed security/GSCC checks and logging to meet regional compliance and platform safety requirements."
  ],
  "features": [
    {
      "name": "Transport Offers API",
      "description": "CRUD operations for driver price bids/offers against a transport request and shipper acceptance of offers.",
      "user_flows": [
        "POST /api/transport/offers with body { trackingId: 'REQ123', driverId: 'DRV1', driverName: 'Ali', driverPhone: '+966500000000', price: 1500, rating: 4.8 } -> Receive 200 { success: true, message: string } -> GET /api/transport/offers?trackingId=REQ123 -> Receive 200 { success: true, offers: any[] }",
        "PATCH /api/transport/offers with body { trackingId: 'REQ123', driverId: 'DRV1' } -> Receive 200 { success: true, message: string }",
        "POST /api/transport/offers with body { trackingId: '', driverId: 'DRV1', price: -10 } -> Receive 400 { success: false, error: string }",
        "GET /api/transport/offers?trackingId=NON_EXISTENT -> Receive 404 { success: false, error: string }",
        "PATCH /api/transport/offers with body { trackingId: 'REQ123', driverId: 'UNKNOWN_DRV' } -> Receive 404 { success: false, error: string }"
      ]
    },
    {
      "name": "Transport Dispatch API",
      "description": "Drivers submit post-acceptance dispatch details (ETA, vehicle info, time window and notes) for a transport request.",
      "user_flows": [
        "POST /api/transport/dispatch with body { trackingId: 'REQ123', eta: '2026-02-22T15:00:00Z', date: '2026-02-22', timeWindow: '15:00-17:00', plateNumber: 'ABC-123', vehicleColor: 'Blue', vehicleType: 'Truck', notes: 'On route' } -> Receive 200 { success: true, message: string }",
        "POST /api/transport/dispatch with body { trackingId: 'REQ123', eta: 'invalid-date', plateNumber: 'ABC-123' } -> Receive 400 { success: false, error: string }",
        "POST /api/transport/dispatch with body { trackingId: 'UNKNOWN_REQ', eta: '2026-02-22T15:00:00Z', plateNumber: 'ABC-123' } -> Receive 404 { success: false, error: string }"
      ]
    },
    {
      "name": "Authentication & Account",
      "description": "User registration, login and profile retrieval for traders, buyers, drivers and admins.",
      "user_flows": [
        "POST /api/auth/register with body { name: 'Ali', role: 'DRIVER', phone: '+966500000000', email: 'ali@example.com', password: 'StrongP@ss1' } -> Receive 200 { success: true, message: string }",
        "POST /api/auth/login with body { email: 'ali@example.com', password: 'StrongP@ss1' } -> Receive 200 { success: true, token: 'JWT' } -> GET /api/auth/me with header Authorization: Bearer JWT -> Receive 200 { success: true, user: { id, name, role, ... } }",
        "POST /api/auth/login with body { email: 'ali@example.com', password: 'wrong' } -> Receive 400 { success: false, error: string }",
        "GET /api/auth/me without Authorization header -> Receive 401 { success: false, error: string }"
      ]
    },
    {
      "name": "Auctions",
      "description": "Create and manage auctions for recyclable lots and accept bids from buyers.",
      "user_flows": [
        "POST /api/auctions with body { title: 'Copper lot', sellerId: 'TRADER1', startingPrice: 10000, endsAt: '2026-03-01T12:00:00Z' } -> Receive 200 { success: true, auctionId: 'AUCT123' } -> GET /api/auctions/AUCT123 -> Receive 200 { success: true, auction: { id: 'AUCT123', currentPrice } }",
        "POST /api/auctions/AUCT123/bid with body { bidderId: 'BUYER1', amount: 10500 } -> Receive 200 { success: true, message: string } -> GET /api/auctions/AUCT123 -> Receive 200 { success: true, auction: { currentPrice: 10500 } }",
        "POST /api/auctions/AUCT123/bid with body { bidderId: 'BUYER2', amount: 100 } -> Receive 400 { success: false, error: 'Bid too low' }",
        "GET /api/auctions/UNKNOWN -> Receive 404 { success: false, error: string }"
      ]
    },
    {
      "name": "Market (Listings)",
      "description": "Create and browse marketplace listings for immediate purchase or negotiation.",
      "user_flows": [
        "GET /api/market/listings?query=copper&page=1 -> Receive 200 { success: true, listings: any[] }",
        "POST /api/market/listings with body { sellerId: 'TRADER1', title: 'Mixed scrap', price: 5000, quantity: 100 } -> Receive 200 { success: true, listingId: string }",
        "POST /api/market/listings with body { sellerId: 'TRADER1', title: 'Missing price' } -> Receive 400 { success: false, error: string }",
        "GET /api/market/listings?query=nonexistent -> Receive 200 { success: true, listings: [] }"
      ]
    },
    {
      "name": "Wallet",
      "description": "User wallet for balances, deposits and withdrawals to settle marketplace and auction transactions.",
      "user_flows": [
        "GET /api/wallet/balance?userId=USER123 -> Receive 200 { success: true, balance: 25000 }",
        "POST /api/wallet/withdraw with body { userId: 'USER123', amount: 5000, method: 'bank' } -> Receive 200 { success: true, transactionId: string }",
        "POST /api/wallet/withdraw with body { userId: 'USER123', amount: 9999999, method: 'bank' } -> Receive 400 { success: false, error: 'Insufficient funds' }",
        "GET /api/wallet/balance?userId=UNKNOWN -> Receive 404 { success: false, error: string }"
      ]
    },
    {
      "name": "GSCC Security & Platform Safety",
      "description": "Security scanning, compliance checks and reporting for uploaded resources and transactions (GSCC).",
      "user_flows": [
        "POST /api/security/scan with body { resourceType: 'listing', resourceId: 'LIST123' } -> Receive 200 { success: true, scanJobId: 'SCAN123' } -> GET /api/security/report/SCAN123 -> Receive 200 { success: true, report: { status: 'clean' } }",
        "POST /api/security/scan without valid API key header -> Receive 401 { success: false, error: string }",
        "GET /api/security/report/UNKNOWN -> Receive 404 { success: false, error: string }"
      ]
    }
  ],
  "code_summary": {
    "version": "2",
    "type": "backend",
    "tech_stack": [
      "typescript",
      "nextjs",
      "prisma",
      "postgresql"
    ],
    "features": [
      {
        "name": "Transport Offers API",
        "description": "CRUD operations for transport bids and offers management between drivers and shippers.",
        "files": [
          "src/app/api/transport/offers/route.ts"
        ],
        "endpoints": [
          {
            "method": "GET",
            "path": "/api/transport/offers?trackingId=REQ123",
            "description": "List all offers for a transport request given the trackingId",
            "auth_required": false,
            "response_schema": {
              "200": "{ success: boolean, offers: any[] }",
              "400": "{ success: false, error: string }",
              "404": "{ success: false, error: string }"
            }
          },
          {
            "method": "POST",
            "path": "/api/transport/offers",
            "description": "Create a new price bid/offer from a driver",
            "auth_required": false,
            "request_schema": {
              "body": {
                "trackingId": "string",
                "driverId": "string",
                "driverName": "string",
                "driverPhone": "string",
                "price": "number",
                "rating": "number"
              }
            },
            "response_schema": {
              "200": "{ success: boolean, message: string }",
              "400": "{ success: false, error: string }",
              "404": "{ success: false, error: string }"
            }
          },
          {
            "method": "PATCH",
            "path": "/api/transport/offers",
            "description": "Accept a specific bid/offer by the shipper",
            "auth_required": false,
            "request_schema": {
              "body": {
                "trackingId": "string",
                "driverId": "string"
              }
            },
            "response_schema": {
              "200": "{ success: boolean, message: string }",
              "400": "{ success: false, error: string }",
              "404": "{ success: false, error: string }"
            }
          }
        ],
        "depends_on": [
          "Database"
        ]
      },
      {
        "name": "Transport Dispatch API",
        "description": "Submission of dispatch details like ETA and vehicle info by driver after their bid is accepted.",
        "files": [
          "src/app/api/transport/dispatch/route.ts"
        ],
        "endpoints": [
          {
            "method": "POST",
            "path": "/api/transport/dispatch",
            "description": "Submit post-acceptance dispatch details",
            "auth_required": false,
            "request_schema": {
              "body": {
                "trackingId": "string",
                "eta": "string",
                "date": "string",
                "timeWindow": "string",
                "plateNumber": "string",
                "vehicleColor": "string",
                "vehicleType": "string",
                "notes": "string"
              }
            },
            "response_schema": {
              "200": "{ success: boolean, message: string }",
              "400": "{ success: false, error: string }",
              "404": "{ success: false, error: string }"
            }
          }
        ],
        "depends_on": [
          "Database"
        ]
      }
    ],
    "known_limitations": []
  }
}
